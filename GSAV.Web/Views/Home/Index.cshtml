@using Microsoft.AspNet.Identity
@using GSAV.Entity.Objects
@using GSAV.Entity.Util
@{
    /**/

    ViewBag.Title = "Home";
}

<div class="contentPaneWide clearfix tabbedPane portal">

    <div class="paneTabs clearfix">
        <h2 class="hideoff" id="anonymous_element_2">Fichas</h2>
        <ul id="paneTabs" class="clearfix nav">
            <li class="active ">
                <a href="@Url.Content("/Home/Index")">Mi institución<span class="hideoff"> (ficha activa)</span></a>
            </li>
            <li class=" ">
                <a href="@Url.Content("/Home/Index")">Panel de notificaciones</a>
            </li>

            <li class="" style="display:none;"></li>
            <li id="overflowLiId" class="sub" style="display: none;">
                <a href="#" id="overflowIconId" class="hiddenTabsLink"></a>
                <ul class="more" id="overflowULId"></ul>
            </li>
        </ul>
    </div>

    <div id="content" class="contentBox clearfix">
        <div class="container clearfix">

            <div class="row">
                <div class="col-md-12">

                    <div class="contentBox contentBox-edit clearfix">

                        <div class="containerPortal clearfix">

                            <div id="column0" class="column-3 clearfix" style="width: 20%;">

                                <div class="portlet clearfix  " id="module:_48_1">
                                    <!-- extid:portal/tools/my_institution: -->
                                    <div class="edit_controls">
                                    </div>


                                    <h2 class="  clearfix" id="anonymous_element_4">
                                        <span class="moduleTitle">Herramientas</span>
                                    </h2>


                                    <div class="collapsible" style="overflow: auto;">

                                        <ul class="portletList">
                                            <li>
                                                <a href="@Url.Content("/Home/Index")" _self">Mi institución</a>
                                            </li>


                                            @if (@Session["Login-Info"] != null && ((ReturnObject<Usuario>)@Session["Login-Info"]).OneResult.Rol == "DOCENTE")
                                            {
                                                <li>
                                                    <a href="@Url.Content("/Consulta/Index")" _self">Bandeja de Consultas</a>
                                                </li>

                                            }

                                            @if (@Session["Login-Info"] != null &&
                                                (((ReturnObject<Usuario>)@Session["Login-Info"]).OneResult.Rol == "DOCENTE" ||
                                                   ((ReturnObject<Usuario>)@Session["Login-Info"]).OneResult.Rol == "COORDINADOR"))
                                            {
                                                <li>
                                                    <a href="@Url.Content("/Consulta/Index")" _self">Base de Conocimiento Académico</a>
                                                </li>

                                            }

                                            @if (@Session["Login-Info"] != null && ((ReturnObject<Usuario>)@Session["Login-Info"]).OneResult.Rol == "COORDINADOR")
                                            {
                                                <li>
                                                    <a href="@Url.Content("/Dashboard/Index")" _self">Dashboard de Consultas</a>
                                                </li>
                                            }


                                        </ul>


                                    </div>
                                </div>

                                <div class="portlet clearfix  " id="module:_522_1">

                                    <div class="edit_controls">
                                    </div>


                                    <h2 class="  clearfix" id="anonymous_element_5">
                                        <span class="moduleTitle">Videotutoriales y manuales de Aprendizaje Digital</span>
                                    </h2>


                                    <div class="collapsible" style="overflow: auto;">

                                        <div class="vtbegenerated"><p style="text-align: center;"><a href="https://www.youtube.com/playlist?list=PLontYaReEU1seUE3ACG3sEc3zR7Br7URU" target="_blank"><img src="~/Content/images/BMANUALES1.jpg" width="100%" height="100%" alt="videotutoriales" title="videotutoriales"></a></p></div>

                                    </div>
                                </div>
                            </div>

                            <div id="column1" class="column-3 clearfix" style="width: 45%;">
                                <div class="portlet clearfix  " id="module:_527_1">

                                    <div class="edit_controls">
                                    </div>


                                    <h2 class="  clearfix" id="anonymous_element_9">
                                        <span class="moduleTitle">Aprendizaje Digital: Recomendaciones y tips</span>
                                    </h2>
                                    <div class="collapsible" style="overflow: auto;">

                                        <div class="vtbegenerated">
                                            <div class="w3-content w3-section" style="max-width: 100%;" align="center">
                                                <a href="https://upc.facebook.com/groups/OneCampus.2017.2/permalink/2108476952803781/" target=" _blank">
                                                    <img alt="" class="mySlides"
                                                         src="http://beta.upc.edu.pe/tice/Modulo_BB/slides/img-a/b_onecamp_01.png"
                                                         style="width: 100%; display: block;">
                                                </a>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="wrapper">
    <div class="chat-box">
        <div class="chat-head">
            <img src="~/Content/images/if_internet-group-chat_118807.png" class="chat-head-img-chat"/>
            <label>UPECITO- CHATBOT</label>
            <img src="https://maxcdn.icons8.com/windows10/PNG/16/Arrows/angle_down-16.png" title="Expand Arrow" width="14" class="chat-head-img-angle">
        </div>
        <div class="chat-body">
            <label class="LabelCSSTop"></label>
            <div id="BotChatGoesHere" style="width:100%;height:400px;" />
        </div>
    </div>
</div>



<script>
    $(function () {
        var arrow = $('.chat-head-img-angle');
        var textarea = $('.chat-text textarea');

        arrow.on('click', function () {
            var src = arrow.attr('src');

            $('.chat-body').slideToggle('fast');
            if (src == 'https://maxcdn.icons8.com/windows10/PNG/16/Arrows/angle_down-16.png') {
                arrow.attr('src', 'https://maxcdn.icons8.com/windows10/PNG/16/Arrows/angle_up-16.png');
            }
            else {
                arrow.attr('src', 'https://maxcdn.icons8.com/windows10/PNG/16/Arrows/angle_down-16.png');
            }
        });

        textarea.keypress(function (event) {
            var $this = $(this);

            if (event.keyCode == 13) {
                var msg = $this.val();
                $this.val('');
                $('.msg-insert').prepend("<div class='msg-send'>" + msg + "</div>");
            }
        });

    });
</script>

<script src="https://cdn.botframework.com/botframework-webchat/latest/botchat.js"></script>

<script type="text/javascript">

function ExecuteChat() {

    var params = BotChat.queryParams(location.search);

    var user = {
        id: "@Session["User-Id"]", //"1",  //params['userid'] || 'userid',
        name: '@User.Identity.GetUserName()' //'Rodrigo Matteo' //params['username'] || 'username'
    };

    console.log(user);

    var bot = {
        id: params['botid'] || 'botid',
        name: params['botname'] || 'botname'
    };
    window['botchatDebug'] = params['debug'] && params['debug'] === 'true';

    BotChat.App({
        bot: bot,
        resize: 'detect',
        sendTyping: true,    // defaults to false. set to true to send 'typing' activities to bot (and other users) when user is typing
        user: user,
        locale: 'es-es', // override locale to Spanish
        directLine: {
            //secret: "mOeE5Yxu2vU.cwA.x7w.CdcXM3Su8-8mPFPrFlhbtdg9uyFrlhsrLYN_btw10tM", //params['s'],
            secret: "wGbQ7RU5d4w.cwA.c3w.SN_0834Z7KNhgIO3Sp8V6p5bqQs7NrGkicKDjJt2wSk",
            webSocket: false
        }
    }, document.getElementById('BotChatGoesHere'));

    $('.wc-header').css('display', 'none');
}

                   
</script>

<script type="text/javascript">

    $(document).ready(function () {
                
        var windowHeight = $(window).height();
        var valheight = $('#globalNavPageNavArea').height();

        $('#globalNavPageContentArea').height(windowHeight - valheight - 50);
        $('#divCointainerRenderBody').height(windowHeight - valheight - 15);
        ExecuteChat();       

    });

</script>


<script type="text/javascript">

    var myIndex = 0;
    carousel();

    function carousel() {
        var i;
        var x = document.getElementsByClassName("mySlides");
        for (i = 0; i < x.length; i++) {
            x[i].style.display = "none";
        }
        myIndex++;
        if (myIndex > x.length) { myIndex = 1 }
        x[myIndex - 1].style.display = "block";
        setTimeout(carousel, 3500);
    }

</script>